// –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram API –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
var TelegramBot = require("node-telegram-bot-api");

// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–æ–∫–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–¥–∞–≤–∞–ª –Ω–∞–º –±–æ—Ç
var token = "1569313818:AAFWE5_3WIfEnlFA0RG8-w25r7_kkO81M7s";
// –í–∫–ª—é—á–∏—Ç—å –æ–ø—Ä–æ—Å —Å–µ—Ä–≤–µ—Ä–∞. –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É Telegram, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
// –ü–æ–¥—Ä–æ–±–Ω–µ–µ: https://core.telegram.org/bots/api#getupdates
var bot = new TelegramBot(token, { polling: true });

// bot.onText(/–Ω–∞–ø–æ–º–Ω–∏ (.+) –≤ (.+)/, function (msg, match) {
//   var userId = msg.from.id;
//   var text = match[1];
//   var time = match[2];

//   notes.push({ uid: userId, time: time, text: text });

//   bot.sendMessage(userId, "–û—Ç–ª–∏—á–Ω–æ! –Ø –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–ø–æ–º–Ω—é, –µ—Å–ª–∏ –Ω–µ —Å–¥–æ—Ö–Ω—É :)");
// });

// setInterval(function () {
//   for (var i = 0; i < notes.length; i++) {
//     const curDate = new Date().getHours() + ":" + new Date().getMinutes();
//     if (notes[i]["time"] === curDate) {
//       bot.sendMessage(
//         notes[i]["uid"],
//         "–ù–∞–ø–æ–º–∏–Ω–∞—é, —á—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã: " + notes[i]["text"] + " —Å–µ–π—á–∞—Å."
//       );
//       notes.splice(i, 1);
//     }
//   }
// }, 1000);
bot.on("polling_error", console.log);

bot.on("message", function (message) {
  if (message.new_chat_members != undefined) {
    console.log(message.new_chat_member.is_bot);
    if (!message.new_chat_member.is_bot) {
      if (message.new_chat_member.last_name)
        bot.sendMessage(
          message.chat.id,
          `<b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —á–∞—Ç "${message.chat.title}"</b>\n${message.new_chat_member.first_name} ${message.new_chat_member.last_name}.\n–°–∏–∑–¥–∏–Ω –ë–∞–∫—Ç—ã–ª—É—É –ò–Ω—Å–∞–Ω –∫–∞–Ω–∞–ª—ã–Ω–∞ –∫–æ—à—É–ª–≥–∞–Ω—ã“£—ã–∑–≥–∞ –∫—É–±–∞–Ω—ã—á—Ç–∞–±—ã–∑üòå! –ë—É–ª –≥—Ä—É–ø–ø–∞–¥–∞–Ω –ø–∞–π–¥–∞–ª—É—É –º–∞–∞–ª—ã–º–∞—Ç—Ç–∞—Ä–¥—ã –∞–ª–∞—Å—ã–∑ –¥–µ–ø –∏—à–µ–Ω–µ–±–∏–∑! –°–∏–∑ –¥–∞ –º–∞–∞–ª—ã–º–∞—Ç—Ç–∞—Ä –º–µ–Ω–µ–Ω –±”©–ª“Ø—à“Ø–ø, —Å–∏–∑ –±–∏–ª–≥–µ–Ω –∏—à —á–∞—Ä–∞–ª–∞—Ä –±–æ—é–Ω—á–∞ –±–∞—à–∫–∞–ª–∞—Ä–¥—ã–Ω –¥–∞ –∫–∞–±–∞—Ä–¥–∞—Ä –±–æ–ª—É—à—É–Ω–∞ —Å–µ–±–µ–ø—á–∏ –±–æ–ª—É“£—É–∑ü§ó.`,
          { parse_mode: "HTML" }
        );
      else
        bot.sendMessage(
          message.chat.id,
          `<b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —á–∞—Ç "${message.chat.title}"</b>\n${message.new_chat_member.first_name} .\n–°–∏–∑–¥–∏–Ω –ë–∞–∫—Ç—ã–ª—É—É –ò–Ω—Å–∞–Ω –∫–∞–Ω–∞–ª—ã–Ω–∞ –∫–æ—à—É–ª–≥–∞–Ω—ã“£—ã–∑–≥–∞ –∫—É–±–∞–Ω—ã—á—Ç–∞–±—ã–∑üòå! –ë—É–ª –≥—Ä—É–ø–ø–∞–¥–∞–Ω –ø–∞–π–¥–∞–ª—É—É –º–∞–∞–ª—ã–º–∞—Ç—Ç–∞—Ä–¥—ã –∞–ª–∞—Å—ã–∑ –¥–µ–ø –∏—à–µ–Ω–µ–±–∏–∑! –°–∏–∑ –¥–∞ –º–∞–∞–ª—ã–º–∞—Ç—Ç–∞—Ä –º–µ–Ω–µ–Ω –±”©–ª“Ø—à“Ø–ø, —Å–∏–∑ –±–∏–ª–≥–µ–Ω –∏—à —á–∞—Ä–∞–ª–∞—Ä –±–æ—é–Ω—á–∞ –±–∞—à–∫–∞–ª–∞—Ä–¥—ã–Ω –¥–∞ –∫–∞–±–∞—Ä–¥–∞—Ä –±–æ–ª—É—à—É–Ω–∞ —Å–µ–±–µ–ø—á–∏ –±–æ–ª—É“£—É–∑ü§ó.`,
          { parse_mode: "HTML" }
        );
    }
  }
});
